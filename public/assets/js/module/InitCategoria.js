import Api from"./Api.js";import CriaFiltro from"./CriaFIltro.js";import CriaProduto from"./CriaProduto.js";export default function InitCategoria(){document.querySelector("#listaProdutos")&&pegaId()}function pegaId(){const t=window.location.search.includes("id=")?window.location.search.split("?")[1].split("&")[0].split("=")[1]:window.location.pathname.replace(".html","").split("/").pop();+t?pegaIdCategoria(t):Api("/api/V1/categories/list",puxaDados)}function puxaDados(t){const e=window.location.pathname.replace(".html","").split("/").pop();pegaIdCategoria(t.items.find((t=>t.path===e)).id)}function pegaIdCategoria(t){Api(`/api/V1/categories/${t}`,carregaProdutos),alteraTextos()}const alteraTextos=()=>{const t=window.location.pathname.replace(".html","").split("/").pop();let e=document.querySelector(".breadcrumb");const r=document.querySelector("h1");e.innerHTML=e.innerHTML+`<p>${t}</p>`,r.innerText=t},carregaProdutos=t=>{const e=t.filters;let r=t.items;location.search.replace(/\?id\=\d+?/,"").length>0&&(r=filtraProdutos(t)),0!==r.length?(r.forEach((t=>{CriaProduto(t)})),e.forEach((e=>{CriaFiltro(e,t.items)}))):mostraErro()},filtraProdutos=t=>{let e=location.search.split("?")[1].split("&"),r=Object.entries(t.filters[0]);if(e=e.map((t=>{let e=t.split("=");if(Number(e[1]))return null;r.filter((e=>t.match(e[0])));return t.split("=")})).filter((t=>null!==t)),0===e.length)return;let o=t.items;return e.forEach((t=>{o=o.filter((e=>{if(e.filter[0][t[0]]===t[1])return e}))})),o},mostraErro=()=>{const t=document.querySelector("#listaProdutos"),e=document.createElement("li");e.classList.add("mensagem--erro"),e.innerHTML='\n    <div class="erro__container"><h2>Lista de produtos não foi encontrada… Tente novamente mais tarde, obrigado</h2><a href="/" class="btn btn--erro" data-link>Voltar para home</a></div>\n  ',t.appendChild(e)};